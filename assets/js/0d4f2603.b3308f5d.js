(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{148:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/awesome-ha-blueprints-04-c5b0817510f4c235c1799a64482ed849.svg"},149:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/awesome-ha-blueprints-01-ad3cf5c209ab4b8b8f8eeada431fa2ec.svg"},150:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/awesome-ha-blueprints-03-c4a51232a4987094ff39f2762dad17f5.svg"},151:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/awesome-ha-blueprints-05-e7fe5786c03c1b4fcd7965edcf353e72.svg"},152:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/awesome-ha-blueprints-02-e123961dd84b35349d592fd337ceb86f.svg"},67:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return r})),n.d(t,"metadata",(function(){return l})),n.d(t,"toc",(function(){return s})),n.d(t,"default",(function(){return d}));var o=n(3),a=n(7),i=(n(0),n(98)),r={title:"Controllers-Hooks Ecosystem"},l={unversionedId:"controllers-hooks-ecosystem",id:"controllers-hooks-ecosystem",isDocsHomePage:!1,title:"Controllers-Hooks Ecosystem",description:"Introduction",source:"@site/docs/controllers-hooks-ecosystem.mdx",slug:"/controllers-hooks-ecosystem",permalink:"/awesome-ha-blueprints/docs/controllers-hooks-ecosystem",editUrl:"https://github.com/EPMatt/awesome-ha-blueprints/edit/main/docs/controllers-hooks-ecosystem.mdx",version:"current",sidebar:"docs",previous:{title:"Importing a Blueprint",permalink:"/awesome-ha-blueprints/docs/importing-a-blueprint"},next:{title:"Contributing",permalink:"/awesome-ha-blueprints/docs/contributing"}},s=[{value:"Introduction",id:"introduction",children:[]},{value:"Controllers",id:"controllers",children:[]},{value:"Hooks",id:"hooks",children:[]},{value:"How to build a controller-based automation",id:"how-to-build-a-controller-based-automation",children:[{value:"Basic Usage: Controller with custom actions",id:"basic-usage-controller-with-custom-actions",children:[]},{value:"Controller and Hook",id:"controller-and-hook",children:[]},{value:"Controller and Hook + Custom actions",id:"controller-and-hook--custom-actions",children:[]},{value:"Controller with multiple Hooks",id:"controller-with-multiple-hooks",children:[]}]},{value:"Examples",id:"examples",children:[{value:"Control a media player with an IKEA E1743",id:"control-a-media-player-with-an-ikea-e1743",children:[]},{value:"Light control with an IKEA E1810 + activate scene with double click",id:"light-control-with-an-ikea-e1810--activate-scene-with-double-click",children:[]}]},{value:"How does it work",id:"how-does-it-work",children:[]}],c={toc:s};function d(e){var t=e.components,r=Object(a.a)(e,["components"]);return Object(i.b)("wrapper",Object(o.a)({},c,r,{components:t,mdxType:"MDXLayout"}),Object(i.b)("h2",{id:"introduction"},"Introduction"),Object(i.b)("p",null,"The Controllers-Hooks ecosystem includes a set of blueprints which allow to easily create controller-based automations in just a few clicks. As the name implies, it consists of two main blueprint categories: Controllers and Hooks."),Object(i.b)("h2",{id:"controllers"},"Controllers"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Controllers")," are blueprints which allow to easily integrate a wide range of controllers (wall switches, remotes, dimmers, etc.) and use them to run a set of actions when interacting with them. They consist in a practical abstraction layer for building controlled-based automations without worrying about the handling of RAW controller events and the integration used to connect controllers to Home Assistant (Zigbee2MQTT, ZHA, deCONZ, ZWave, proprietary hubs, etc.)."),Object(i.b)("div",{className:"admonition admonition-info alert alert--info"},Object(i.b)("div",{parentName:"div",className:"admonition-heading"},Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",{parentName:"h5",className:"admonition-icon"},Object(i.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(i.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),Object(i.b)("div",{parentName:"div",className:"admonition-content"},Object(i.b)("p",{parentName:"div"},"The type of exposed events depends on the controller model. Some controllers can also expose virtual events (ie. controller events not implemented by the manufacturer, such as button double clicks, etc.) which can be enabled by the user."))),Object(i.b)("p",null,"Most importantly, beside providing custom action sequences to Controller blueprints, you can connect Controllers with ",Object(i.b)("a",{parentName:"p",href:"#hooks"},"Hooks"),"."),Object(i.b)("h2",{id:"hooks"},"Hooks"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Hooks")," are blueprints which seamlessly integrate with ",Object(i.b)("a",{parentName:"p",href:"#controllers"},"Controllers")," to enable control of lights, media players and much more, without you ever writing a single line of code."),Object(i.b)("p",null,"While Controllers are responsible for integrating the hardware and exposing an abstract interface to the user, Hooks can, as the name suggests, link to this interface and listen for events fired by a Controller. With the received events, Hooks take care of providing the actual control functionality for common use cases (eg. controlling a Media Player)."),Object(i.b)("h2",{id:"how-to-build-a-controller-based-automation"},"How to build a controller-based automation"),Object(i.b)("h3",{id:"basic-usage-controller-with-custom-actions"},"Basic Usage: Controller with custom actions"),Object(i.b)("p",null,Object(i.b)("img",{alt:"Basic Usage: Controller with custom actions",src:n(148).default})),Object(i.b)("p",null,"The simplest use case for such blueprints consists in creating an entirely custom controller-based automation, which can be done by using only a Controller blueprint."),Object(i.b)("p",null,"When setting up an automation with a Controller blueprint, you'll be asked to select the integration used to connect the controller to Home Assistant, and the ",Object(i.b)("inlineCode",{parentName:"p"},"device")," or ",Object(i.b)("inlineCode",{parentName:"p"},"entity")," (depending on the integration) representing the Controller. You can then specify a sequence of actions for each of the events the controller exposes."),Object(i.b)("p",null,"Each time an event is fired by the controller (eg. button press) the automation will run the provided custom action corresponding to that specific event."),Object(i.b)("div",{className:"admonition admonition-info alert alert--info"},Object(i.b)("div",{parentName:"div",className:"admonition-heading"},Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",{parentName:"h5",className:"admonition-icon"},Object(i.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(i.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),Object(i.b)("div",{parentName:"div",className:"admonition-content"},Object(i.b)("p",{parentName:"div"},"Some controllers require to provide an ",Object(i.b)("inlineCode",{parentName:"p"},"input_text")," entity to recognize some actions. This varies between different controller models and integrations, but it's required when implementing virtual double press events."),Object(i.b)("p",{parentName:"div"},"This is due to the actions mapping for the controller with these integrations, since natively the controller doesn't allow to distinguish between certain button events, so the blueprint needs to store the previous event, using the text input, and take advantage of this information for subsequent events."),Object(i.b)("p",{parentName:"div"},"Before setting up the automation, create a brand new  ",Object(i.b)("inlineCode",{parentName:"p"},"input_text")," entity in your Home Assistant, then provide it to the blueprint, when required. ",Object(i.b)("strong",{parentName:"p"},"Make sure the input is not shared between multiple automations, and is not altered by any other agent"),", since this could lead to inconsistencies in the automation."))),Object(i.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(i.b)("div",{parentName:"div",className:"admonition-heading"},Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",{parentName:"h5",className:"admonition-icon"},Object(i.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},Object(i.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),Object(i.b)("div",{parentName:"div",className:"admonition-content"},Object(i.b)("p",{parentName:"div"},"Even in this simple scenario, you can still benefit from most of the features of the ecosystem: the blueprint will take care of handling the RAW events fired by the controller, as well as providing virtual events (eg. double clicks) not natively exposed by the controller."))),Object(i.b)("h3",{id:"controller-and-hook"},"Controller and Hook"),Object(i.b)("p",null,Object(i.b)("img",{alt:"Controller and Hook",src:n(149).default})),Object(i.b)("p",null,"If you want to build a controller-based automation with Hooks, first create an automation with a Controller blueprint. You can then build an automation with the desired Hook blueprint, ",Object(i.b)("strong",{parentName:"p"},"making sure that you provide the same controller ",Object(i.b)("inlineCode",{parentName:"strong"},"device")," or ",Object(i.b)("inlineCode",{parentName:"strong"},"entity")," used in the corresponding Controller blueprint"),". This key step will link the two automations and ensure the Hook will respond to events fired by the Controller."),Object(i.b)("div",{className:"admonition admonition-info alert alert--info"},Object(i.b)("div",{parentName:"div",className:"admonition-heading"},Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",{parentName:"h5",className:"admonition-icon"},Object(i.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(i.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),Object(i.b)("div",{parentName:"div",className:"admonition-content"},Object(i.b)("p",{parentName:"div"},"Please note that not all controllers might be used with each of the available Hooks. Check out the Hook documentation for the list of supported controllers for that specific Hook.  "))),Object(i.b)("h3",{id:"controller-and-hook--custom-actions"},"Controller and Hook + Custom actions"),Object(i.b)("p",null,Object(i.b)("img",{alt:"Controller and Hook + Custom actions",src:n(150).default})),Object(i.b)("p",null,"If you need to customize certain actions or extend a Hook functionality, you can also provide custom actions to the Controller blueprint, which will be run when a certain event is raised."),Object(i.b)("h3",{id:"controller-with-multiple-hooks"},"Controller with multiple Hooks"),Object(i.b)("p",null,Object(i.b)("img",{alt:"Controller with multiple Hooks",src:n(151).default})),Object(i.b)("p",null,"For more flexibility, you can link multiple Hooks to the same Controller: just create a Controller automation, then build as many Hook automations as needed."),Object(i.b)("p",null,"This might be useful when you'd like to control multiple devices with the same controller (eg. multiple media players or lights) without relying on Home Assistant groups."),Object(i.b)("h2",{id:"examples"},"Examples"),Object(i.b)("h3",{id:"control-a-media-player-with-an-ikea-e1743"},"Control a media player with an IKEA E1743"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-yaml"},"# Controller automation: integrate the IKEA E1743\n- alias: Controller - IKEA E1743 Kitchen\n  description: ''\n  use_blueprint:\n    path: EPMatt/ikea_e1743.yaml\n    input:\n      integration: Zigbee2MQTT\n      controller_entity: sensor.ikea_e1743_action\n      helper_last_controller_event: input_text.ikea_e1743_helper\n      button_up_double_press: true\n      button_down_double_press: true\n\n# Hook automation: Link the media player with the Controller\n- alias: Hook - Control Kitchen Media Player with E1743\n  description: ''\n  use_blueprint:\n    path: EPMatt/media_player.yaml\n    input:\n      # Provide the same value used in the Controller automation\n      # This ensures this automation will catch events fired by the E1743\n      controller_entity: sensor.ikea_e1743_action\n      controller_model: IKEA E1743 On/Off Switch\n      media_player: media_player.kitchen\n")),Object(i.b)("h3",{id:"light-control-with-an-ikea-e1810--activate-scene-with-double-click"},"Light control with an IKEA E1810 + activate scene with double click"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-yaml"},"# Controller automation: integrate the IKEA E1810\n- alias: Controller - IKEA E1810 Living Room\n  description: ''\n  use_blueprint:\n    path: EPMatt/ikea_e1524_e1810.yaml\n    input:\n      integration: Zigbee2MQTT\n      controller_entity: sensor.ikea_e1810_action\n      # Example of custom action\n      # activate a scene when double clicking the center button\n      action_button_center_double:\n        - scene: scene.cinema_mode\n\n# Hook automation: link the light with the Controller\n- alias: Hook - Control living room lights with IKEA E1810\n  description: ''\n  use_blueprint:\n    path: EPMatt/light.yaml\n    input:\n      light_color_mode: RGB\n      # Provide the same value used in the Controller automation\n      # This ensures this automation will catch events fired by the E1810\n      controller_entity: sensor.ikea_e1810_action\n      controller_model: IKEA E1524/E1810 5-Button remote\n      light: light.livingroom_ceiling\n")),Object(i.b)("h2",{id:"how-does-it-work"},"How does it work"),Object(i.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(i.b)("div",{parentName:"div",className:"admonition-heading"},Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",{parentName:"h5",className:"admonition-icon"},Object(i.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(i.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(i.b)("div",{parentName:"div",className:"admonition-content"},Object(i.b)("p",{parentName:"div"},"This section discusses the communication and inner implementation of Controllers and Hooks. You don't need to read or know it to properly use Cthese blueprints."))),Object(i.b)("div",{className:"admonition admonition-caution alert alert--warning"},Object(i.b)("div",{parentName:"div",className:"admonition-heading"},Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",{parentName:"h5",className:"admonition-icon"},Object(i.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},Object(i.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"Note")),Object(i.b)("div",{parentName:"div",className:"admonition-content"},Object(i.b)("p",{parentName:"div"},"This documentation section is currently under review."))),Object(i.b)("p",null,Object(i.b)("img",{alt:"Under the hood",src:n(152).default})))}d.isMDXComponent=!0},98:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return h}));var o=n(0),a=n.n(o);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=a.a.createContext({}),d=function(e){var t=a.a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},u=function(e){var t=d(e.components);return a.a.createElement(c.Provider,{value:t},e.children)},b={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},m=a.a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,r=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=d(n),m=o,h=u["".concat(r,".").concat(m)]||u[m]||b[m]||i;return n?a.a.createElement(h,l(l({ref:t},c),{},{components:n})):a.a.createElement(h,l({ref:t},c))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,r=new Array(i);r[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,r[1]=l;for(var c=2;c<i;c++)r[c]=n[c];return a.a.createElement.apply(null,r)}return a.a.createElement.apply(null,n)}m.displayName="MDXCreateElement"}}]);